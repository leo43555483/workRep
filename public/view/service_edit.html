<!DOCTYPE html>
<html lang="en">

<head>
</head>

<body>
    <div class="popup_out">
        <form service="form" method="post" id="myform" action="<c:url value='${backend}/service/update.do' />" enctype="multipart/form-data">
            <input type="hidden" name="token" value="${sessionScope.token}" />
            <input type="hidden" name="id" value="${requestScope.service.id }" />
            <input type="hidden" name="menuId" value="${curMenu.id }" />
            <div class="poptit"><span class="t">
                    服务编辑</span></div>
            <div class="popcontent">
                <ul class="formlist">
                    <li class="item">
                        <div class="item_in">
                            <span class="label">
                                <span class="must"></span>
                                服務編碼
                            </span>
                            <input type="text" name="name" class="input_text  required" disabled placeholder=""
                                maxlength="50" value="S-WM-OA-Index">
                        </div>
                    </li>
                    <li class="item">
                        <div class="item_in">
                            <span class="label">
                                <span class="must"></span>
                                服務名稱
                            </span>
                            <input type="text" name="name" class="input_text  required" placeholder="" maxlength="50"
                                value="A-WM-OA">
                        </div>
                    </li>
                </ul>
                <div id="serviceAdd">
                    <ul class="formlist formlist_np" id="serviceDel1">
                        <li class="item half">
                            <div class="item_in">
                                <span class="label">服務地址</span>
                                <input type="text" name="ip" class="input_text" placeholder="" maxlength="50" value="127.0.0.1">
                            </div>
                        </li>
                        <li class="item half">
                            <div class="item_in">
                                <span class="label">服務URL</span>
                                <div class="input-group">
                                    <input type="text" name="url" class="form-control input_text" placeholder=""
                                        maxlength="50" value="http://192.168.1.34">
                                    <a onclick="addService(this,1);" class="input-group-addon btn_add">+</a>
                                </div>
                            </div>
                        </li>
                    </ul>
                </div>
                <ul class="formlist formlist_np">
                    <li class="item">
                        <div class="item_in">
                            <span class="label">服務端口</span>
                            <input type="text" name="port" class="input_text " placeholder="" maxlength="50" value="81">
                        </div>
                    </li>
                    <li class="item">
                        <div class="item_in">
                            <span class="label">二級目錄</span>
                            <input type="text" name="frontendBaseUrl" class="input_text " placeholder="" maxlength="50"
                                value="/wm_oa">
                            <span class="help-block" data-title="二級目錄，就是子目錄，繼承在主站目錄下的，相當於網站的跟目錄在建立一個資料夾存放網站。無則留空如，http://www.baidu.com/blog/"></span>
                        </div>
                    </li>
                    <li class="item">
                        <div class="item_in">
                            <span class="label">服務所屬平臺</span>
                            <div class="customSelect_out">
                                <select name="applicationId">
                                    <option value="18" selected="selected">办公平台</option>
                                    <option value="16">spu</option>
                                    <option value="17">member</option>
                                    <option value="14">数据中心</option>
                                    <option value="15">mian-server</option>
                                </select>
                            </div>
                        </div>
                    </li>

                    <li class="item">
                        <div class="item_in">
                            <span class="label">是否發佈</span>
                            <label>
                                <input type="radio" name="isReleased" value="1" class="input_radio" checked="checked" />發佈
                            </label>
                            <label>
                                <input type="radio" name="isReleased" value="0" class="input_radio" />不發佈
                            </label>
                        </div>
                    </li>
                    <li class="item">
                        <div class="item_in">
                            <span class="label">服務描述</span>
                            <textarea name="intro" class="textarea " maxlength="50"></textarea>
                        </div>
                    </li>
                </ul>
                <div class="subbox">
                    <input type="submit" value="確認" class="submit" />
                    <input type="button" value="取消" class="cancel xboxClose_btn" />
                </div>
            </div>
        </form>
    </div>
    <script type="text/javascript">

        function addService(obj, index) {
            // 	$(obj).remove();
            service_html = "<ul class=\"formlist formlist_np\" id=\"serviceDel" + (index + 1) + "\">" +
                "<li class=\"item half\"><div class=\"item_in\">" +
                "<span class=\"label\">服務地址</span> " +
                "<input type=\"text\" name=\"ip\" class=\"input_text\" placeholder=\"\" maxlength=\"50\" value=\"\">" +
                "</div></li>" +
                "<li class=\"item half\"><div class=\"item_in\">" +
                "<span class=\"label\">服務URL</span> " +
                "<div class=\"input-group\"><input type=\"text\" name=\"url\" class=\"form-control input_text\" placeholder=\"\" maxlength=\"50\" value=\"\"> <!-- <a onclick=\"addService(this," + (index + 1) + ");\" class=\"input-group-addon btn_add\">+</a> --> <a onclick=\"delService(" + (index + 1) + ");\" class=\"input-group-addon btn_del\">-</a></div>" +
                "</div></li></ul>";
            $("#serviceAdd").append(service_html);
        }

        function delService(index) {
            if (index == 1) {
                return;
            }
            $("#serviceDel" + index).remove();
        }

    </script>
    <script type="text/javascript">
        $(function () {
            $(".customSelect_out select").SumoSelect();
            $(".input_check, .input_radio").iCheck({
                checkboxClass: "icheckbox_square-blue",
                radioClass: "iradio_square-blue"
            });


            $('#myform').find(':submit').removeAttr('disabled');
            $('#myform').find(':submit').val('確認');

            $("#myform").validate({
                rules: {
                    code: {
                        remote: {
                            type: "POST",
                            url: "${ctx}/admin/service/isExist.ajax",
                            data: {
                                // notId: ${ requestScope.service.id },
                                notId: 11,
                code: function () {
                    return $('input[name=code]').val();
                },
                m: Math.random()
    					   } 
    					} 
    				  }
    				},
            messages: {
                code: {
                    remote: "不能出現重複編碼"
                }
            },
            submitHandler: function (form) {
                /* $('#myform').find(':submit').attr('disabled', 'disabled');
                $('#myform').find(':submit').val('<fmt:message key="preservation" />...');
 
                form.submit(); */
                submitForm(form, function (data) {
                    $('#servicetree').jstree(true).refresh();
                    loadView(data.id);
                })
            } 
    		});
    });					
    </script>
    <script type="text/javascript">
        $('.help-tips').each(function () {
            $(this).mouseover(function () {
                layer.tips($(this).attr('data-title'), $(this), {
                    time: 0,
                    skin: 'layui-layer-tips_1'
                });
                console.log(1)
            }).mouseout(function () {
                layer.closeAll('tips');
            })
        })
    </script>
</body>

</html>